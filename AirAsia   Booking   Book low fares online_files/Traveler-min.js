$(function(){$(document).ready(function(){$("#divForm").hide();$("#divGuestListForm").hide();$("#divGuestDetailForm").hide();$("#divGuestDetailSubForm").hide();$("div[id*='divInsurancePanel']").hide();$("div[id*='divExternalInsurance']").hide();setupMealPanels();setupComfortKitPanels();setupDutyFreePanels();$("a.login-panel").click(function(){$("#lightbox-background").css("height",$(document).height());$("#lightbox-background, #lightbox-panel").fadeIn(300,function(){});});$("a#close-panel").click(function(){$("#lightbox-background, #lightbox-panel").fadeOut(300);});if($("#hdRememberMeEmail").val()!=""){$("#MemberLoginTravelerView2_TextBoxUserID").val($("#hdRememberMeEmail").val());}});});var ValidationAlert={messages:[],push:function(a){ValidationAlert.messages.push(a);},show:function(){if(this.messages[0]){alertSBP(this.messages[0]);}},clear:function(){ValidationAlert.messages=[];}};function btnGuestDetailsValidate(){if(!Page_ClientValidate("ContactGroupVal")){alert(TravelerVal.Lang.AlrtGuestDetails);return false;}if(!validateGuests()){return false;}var b=0,k=0;var c=$find(radTabGuest).get_tabs().get_count();var a=typeOfGuests.split(" ");for(var h=0;h<c;h++){if(a[h]=="A"){b+=1;}else{if(a[h]=="C"){k+=1;}}}var e=b-1;if(e!=0){if(hasDuplicateAdultName(0,e)){return false;}}if(k>1){if(hasDuplicateChildName(b,e+k)){return false;}}var h=0,f=0,d=0,j="";for(h=0;h<c;h++){j="#BodyContent_ucTravelerForm"+(h+1)+"_form_";if(!$(j+"divInsurancePanel").is(":hidden")){d++;}}var g=$(".chkTravelInsuranceTarget").children("input:checked").length;if(g>0&&g!=d){alert(TravelerVal.Lang.InsurancePrompter);$(".chkTravelInsuranceTarget").children("input:checkbox").removeAttr("checked").each(function(){$(this).triggerHandler("click");});return false;}else{return true;}return false;}function hasDuplicateTravelingGuest(a,e){if(a==e){return false;}for(var d=a;d<e;d++){var b="ctl00_BodyContent_ucTravelerForm"+(a+1)+"_form_";var c="ctl00_BodyContent_ucTravelerForm"+(d+2)+"_form_";if($find(b+"cmbTravelingGuest").get_value()==$find(c+"cmbTravelingGuest").get_value()){return true;}}return hasDuplicateTravelingGuest(a+1,e);}function hasDuplicateAdultName(e,a){if(e==a){return false;}for(var d=e;d<a;d++){var b="ctl00_BodyContent_ucTravelerForm"+(e+1)+"_form_";var c="ctl00_BodyContent_ucTravelerForm"+(d+2)+"_form_";if($find(b+"cmbTitleCombo").get_value()==$find(c+"cmbTitleCombo").get_value()&&$find(b+"txtFirstName").get_value().toLowerCase().trim()==$find(c+"txtFirstName").get_value().toLowerCase().trim()&&$find(b+"txtLastName").get_value().toLowerCase().trim()==$find(c+"txtLastName").get_value().toLowerCase().trim()){alert(TravelerVal.Lang.DuplicateNamePrompter+": "+$find(b+"txtFirstName").get_value().trim()+" "+$find(b+"txtLastName").get_value().trim());return true;}}return hasDuplicateAdultName(e+1,a);}function hasDuplicateChildName(e,d){if(e==d){return false;}for(var c=e;c<d;c++){var a="ctl00_BodyContent_ucTravelerForm"+(e+1)+"_form_";var b="ctl00_BodyContent_ucTravelerForm"+(c+2)+"_form_";if($find(a+"txtFirstName").get_value().toLowerCase().trim()==$find(b+"txtFirstName").get_value().toLowerCase().trim()&&$find(a+"txtLastName").get_value().toLowerCase().trim()==$find(b+"txtLastName").get_value().toLowerCase().trim()){alert(TravelerVal.Lang.DuplicateNamePrompter+": "+$find(a+"txtFirstName").get_value().trim()+" "+$find(a+"txtLastName").get_value().trim());return true;}}return hasDuplicateChildName(e+1,d);}function validateGuests(){var c=$find(radTabGuest).get_tabs().get_count();var f=$find(radTabGuest).get_selectedIndex();var e=true;ValidationAlert.clear();var d=f==-1?0:f;do{selectGuestTab(d+1);var b="ctl00_BodyContent_ucTravelerForm"+(d+1)+"_form_";if($find(b+"txtFirstName").get_value()==""&&f!=d){var a=$(".left-col-content").offset().top;$("html,body").scrollTop(a);e=false;ValidationAlert.show();return false;}if(!Page_ClientValidate("GuestGroupVal_"+d)||!additionalGuestValidation(d)||!validateAddOns(d)){e=false;ValidationAlert.show();return false;}d=(d+1)%c;}while(d!=f);if(!validateAddOnsGlobal()){e=false;}ValidationAlert.show();return e;}function additionalGuestValidation(a){var c=true;prefix="BodyContent_ucTravelerForm"+(a+1)+"_form_";prefix2="ctl00_BodyContent_ucTravelerForm"+(a+1)+"_form_";if(bookingRulesManager.IsHideNationality!=true){var b=$find(prefix2+"cmbNationality").get_value();if(b=="IL"&&bookingRulesManager.IsBlockIsrael==true){ValidationAlert.push(TravelerVal.Lang.AlrtIsraelPassenger);c=false;}}return c;}function validateAddOns(b){var d=true;var e=b+1;var c=$(".meal-premium-closed-agreement-checkbox "+" input[type=checkbox]:not(:hidden)");$(".meal-premium-closed-agreement-checkbox").removeClass("ValidationErrors");if(c.not(":checked").length>0){c.not(":checked").parent("span.meal-premium-closed-agreement-checkbox").addClass("ValidationErrors");d=false;c.eq(0).parents("li:eq(0)").find(".mealPanelBtn").focus();}var a=$("#BodyContent_ucTravelerForm"+(e)+" .ucmealpanel");a.each(function(f,g){if($(this).ucMealPanel("disabled")||$(this).ucMealPanel("freeMealCount")==0){return;}if($(this).ucMealPanel("count")<$(this).ucMealPanel("freeMealCount")){if(d){ValidationAlert.push(TravelerVal.Lang.MsgComplimentaryMeal);}d=false;return false;}});return d;}function validateAddOnsGlobal(){var a=true;return a;}function ValidateText_OnBlur(b,a){}function ValidateNumber_OnBlur(b,a){}function cvDOBRequired_Validator(j,l){var f=parseInt($(j).parents(".divGuestDetailForm:eq(0)").attr("data-page-number"));var k="BodyContent_ucTravelerForm"+(f+1)+"_form_";var e="ctl00_BodyContent_ucTravelerForm"+(f+1)+"_form_";var h=$find(e+"cmbDOBDay").get_value();var n=$find(e+"cmbDOBDay").get_id();var m=$find(e+"cmbDOBMonth").get_value();var g=$find(e+"cmbDOBYear").get_value();var d=$("#"+k+"hfDOBDay").val();var b=$("#"+k+"hfDOBMonth").val();var a=$("#"+k+"hfDOBYear").val();if(isEmpty(g)||isEmpty(m)||isEmpty(h)||isEmpty(a)||isEmpty(b)||isEmpty(d)){l.IsValid=false;if($.browser.webkit){$("#"+n).prop("tabindex",-1).focus();}else{var c=$("#"+n).offset().top;if($("html,body").scrollTop()>c){$("html,body").scrollTop(c);}}}else{l.IsValid=true;}}function cvDOBAge_Validator(c,e){var k=parseInt($(c).parents(".divGuestDetailForm:eq(0)").attr("data-page-number"));var q="BodyContent_ucTravelerForm"+(k+1)+"_form_";var h="ctl00_BodyContent_ucTravelerForm"+(k+1)+"_form_";var m=$find(h+"cmbDOBDay").get_value();var r=$find(h+"cmbDOBDay").get_id();var o=$find(h+"cmbDOBMonth").get_value();var g=$find(h+"cmbDOBYear").get_value();var f=$("#"+q+"hfDOBDay").val();var n=$("#"+q+"hfDOBMonth").val();var a=$("#"+q+"hfDOBYear").val();var p=typeOfGuests.split(" ");var j=$("#"+q+"cvDOBRequired").get(0);if(j.isvalid){var l=new Date(lastDepartureDate);var s=new Date(lastDepartureDate);var d=new Date(a,parseInt(n)-1,f);switch(p[k]){case"A":l.setFullYear(l.getFullYear()-130);s.setFullYear(s.getFullYear()-12);if(d<l||d>s){e.IsValid=false;$(c).html(TravelerVal.Lang.AlrtAdult);c.errormessage=TravelerVal.Lang.AlrtAdult;}else{e.IsValid=true;}break;case"C":l.setFullYear(l.getFullYear()-12);s.setFullYear(s.getFullYear()-2);if(d<=l||d>s){e.IsValid=false;$(c).html(TravelerVal.Lang.AlrtChild);c.errormessage=TravelerVal.Lang.AlrtChild;}else{e.IsValid=true;}break;case"I":l.setFullYear(l.getFullYear()-2);s.setDate(s.getDate()-9);if(d<=l||d>s){e.IsValid=false;$(c).html(TravelerVal.Lang.AlrtInfant);c.errormessage=TravelerVal.Lang.AlrtInfant;}else{e.IsValid=true;}break;}}else{e.IsValid=true;}if(!e.IsValid){if($.browser.webkit){$("#"+r).prop("tabindex",-1).focus();}else{var b=$("#"+r).offset().top;if($("html,body").scrollTop()>b){$("html,body").scrollTop(b);}}}}function cvTravelingGuest_Validator(f,d){var c=$find(radTabGuest).get_tabs().get_count();var h=$find(radTabGuest).get_selectedIndex();var b="ctl00_BodyContent_ucTravelerForm"+(h+1)+"_form_";if($find(b+"cmbTravelingGuest")){var a=0;var g=typeOfGuests.split(" ");for(var e=0;e<c;e++){if(g[e]=="I"){a=e;break;}}if(h>a){if(hasDuplicateTravelingGuest(a,h)){d.IsValid=false;return;}}}d.IsValid=true;}function populateContactAsGuest(){var b;var c="ctl00_BodyContent_ucTravelerForm1_form_";if($("#BodyContent_ucTravelerForm1_form_chkIAmFlying").prop("checked")){var a=$find(c+"txtFirstName");a.set_value($find(txtContactFirstName).get_value());a.focus();a=$find(c+"txtLastName");a.set_value($find(txtContactLastName).get_value());a.focus();a=$find(c+"cmbTitleCombo");a.trackChanges();b=a.findItemByValue($find(cmbContactTitle).get_value());if(b!=null){b.select();}a.commitChanges();if(bookingRulesManager.IsHideNationality!=true){a=$find(c+"cmbNationality");}}}function populateGuest(){var c=[];var a=[];var e=0;var d=0;var b=0;$("#divGuestListForm :checked").each(function(){var f=$(this).val().split("|");c.push(f[0]);a.push(f[1]);if(f[1]=="ADT"){e+=1;}else{if(f[1]=="CHD"){d+=1;}else{if(f[1]=="INFT"){b+=1;}}}});if(c.length>$find(radTabStrip1).get_tabs().get_count()){alert(Traveler.Lang.err_AGFNM);}else{if(e>bookingRulesManager.PaxTypeAdult||d>bookingRulesManager.PaxTypeKid||b>bookingRulesManager.PaxTypeInfant){alert(TravelerVal.Lang.AlrtPsgNotMatch);}else{$.each(c,function(j,o){selectGuestTab(1);var k=j;if(a[j]=="CHD"){k=j+(j%bookingRulesManager.PaxTypeAdult);}if(a[j]=="INFT"){k=j+(j%(bookingRulesManager.PaxTypeAdult+bookingRulesManager.PaxTypeKid));}var f="ctl00_BodyContent_ucTravelerForm"+(k+1)+"_form_";var l=$find(f+"txtFirstName");l.set_value(contactList[c[j]].FirstName);l.focus();l=$find(f+"txtLastName");l.set_value(contactList[c[j]].LastName);l.focus();var m;var h;if(a[j]=="ADT"){h=$find(f+"cmbTitleCombo");h.trackChanges();m=h.findItemByValue(contactList[c[j]].Title);if(m!=null){m.select();}h.commitChanges();}if(a[j]=="INFT"){h=$find(f+"cmbGenderCombo");h.trackChanges();m=h.findItemByValue(contactList[c[j]].Gender);if(m!=null){m.select();}h.commitChanges();}h=$find(f+"cmbNationality");h.trackChanges();m=h.findItemByValue(contactList[c[j]].Nationality);if(m!=null){m.select();}h.commitChanges();var g=contactList[c[j]].DateOfBirth.split("T");g=g[0].split("-");var n=new Date(g[0],g[1]-1,g[2],0,0,0,0);setDateCombo(f,"cmbDOBDay",n.getDate());setDateCombo(f,"cmbDOBMonth",n.getMonth()+1);setDateCombo(f,"cmbDOBYear",n.getFullYear());});}}}function setDateCombo(b,a,d){var c=$find(b+a);c.trackChanges();comboItem=c.findItemByValue(d);if(comboItem!=null){comboItem.select();}c.commitChanges();}function resetCombo(b,a){var c=$find(b+a);c.trackChanges();comboItem=c.findItemByText("");if(comboItem!=null){comboItem.select();}c.commitChanges();}function selectContactForm(){var a=$find(radTabContact);var c=a.get_tabs();for(var b=0;b<c.get_count();b++){c.getTab(b).set_selected(false);}var d=$find(radMultiPage);d.set_visible(false);c.getTab(0).set_selected(true);$("#divGuestDetailForm").hide();$("#divGuestDetailSubForm").hide();$("#divGuestListForm").hide();$("#divContactForm").show();}function selectGuestTab(d){var a=$find(radTabStrip1);var c=a.get_tabs();for(var b=0;b<c.get_count();b++){c.getTab(b).set_selected(false);}c.getTab((d-1)).set_selected(true);$("#BodyContent_ucTravelerForm"+d).css("display","block");$("#divGuestDetailForm").show();$("#divGuestDetailSubForm").show();$("#divGuestListForm").hide();$("#divContactForm").hide();adjustAddOnItemSizes("BodyContent_ucTravelerForm"+d);}function toggleMeal(a){$("#"+a+" dd").hide();$("#"+a+" dt a").click(function(){for(var c=1;c<=4;c++){var b=("meal"+c);if(a!=b){$("#"+b+" dd").hide();}}$("#"+a+" dd").toggle(500);});}function setupMealPanels(){var c=new Array();var a=new Array();var b=new Array();if($.browser.msie){$(".dropdownMeal dd").each(function(e){c[e]=$(this).find("div").attr("id");});}$(".dropdownMeal dd").each(function(){$(this).attr("data-width",$(this).find(".ucmealpanel").outerWidth());}).hide().css("visibility","visible");$(".ucmealpanel").hover(function(){$("body").attr("data-ucmp-hovered","true");},function(){$("body").attr("data-ucmp-hovered","false");});$(document).click(function(e){if($("body").attr("data-ucmp-hovered")!="true"&&$(".dropdownMeal dd.visible").length>0){if($.browser.msie){$(".dropdownMeal").find("dd.visible").find(".ucmealpanel-item-container").each(function(){if($(this).css("display")=="block"){for(var g=0;g<$(".dropdownMeal").find("dd").length;g++){if($(this).attr("id").indexOf(c[g])>=0){a[g]=$(this).attr("id");b[g]=$(this).scrollLeft();break;}}}});}var f=$(".dropdownMeal");f.find("dd").fadeOut("fast").removeClass("visible");f.find("dt").removeClass("active");if($.browser.msie){$("ul.add-on-forms").children("li").show();$("div.ssrWrapper").find(".mealPanelBtn").show();}}});$(".ucmealpanel-close-btn").click(function(e){if($.browser.msie){$(this).parents(".dropdownMeal").find("dd").find(".ucmealpanel-item-container").each(function(){if($(this).css("display")=="block"){for(var g=0;g<$(".dropdownMeal").find("dd").length;g++){if($(this).attr("id").indexOf(c[g])>=0){a[g]=$(this).attr("id");b[g]=$(this).scrollLeft();break;}}}});}var f=$(".dropdownMeal");f.find("dd").fadeOut("fast").removeClass("visible");f.find("dt").removeClass("active");if($.browser.msie){$("ul.add-on-forms").children("li").show();$("div.ssrWrapper").find(".mealPanelBtn").show();}return false;});var d=$(".dropdownMeal");d.find("dt").children("a").on("click",function(j){j.stopPropagation();if($.browser.msie){$(".dropdownMeal").find("dd.visible").find(".ucmealpanel-item-container").each(function(){if($(this).css("display")=="block"){for(var l=0;l<$(".dropdownMeal").find("dd").length;l++){if($(this).attr("id").indexOf(c[l])>=0){a[l]=$(this).attr("id");b[l]=$(this).scrollLeft();break;}}}});}var h=$(this).closest(".dropdownMeal");if(h.find("dd").hasClass("visible")){h.find("dd").fadeOut("fast",function(){});h.find("dd").removeClass("visible");h.find("dt").removeClass("active");if($.browser.msie){$("ul.add-on-forms").children("li").show();$("div.ssrWrapper").find(".mealPanelBtn").show();}}else{d.find("dd").hide().removeClass("visible");d.find("dt").removeClass("active");var e=h.find(".ucmealpanel-wrapper");var f=h.find("dd");var k=20;f.css({"display":"block","visibility":"hidden"});e.css("left",0);if(e.offset().left+e.outerWidth()+k>$(window).width()){if(e.outerWidth()>$(window).width()){e.css("left","-"+e.offset().left+"px");}else{e.css("left","-"+(e.offset().left+k+e.outerWidth()-$(window).width())+"px");}}f.css({"display":"none","visibility":"visible"});f.addClass("visible");h.find("dt").addClass("active");e.hide();f.show();e.show(500,function(){});if($.browser.msie){for(var g=0;g<$(".dropdownMeal").find("dd").length;g++){if(a[g]!==""){$("#"+a[g]).scrollLeft(b[g]);}}}}return false;});$(".ucmealpanel").ucMealPanel("onchange");}function setupComfortKitPanels(){var a=$(".dropdownComfort");a.find("dd").each(function(){$(this).attr("data-width",$(this).find(".uccomfortkitpanel").outerWidth());});a.find("dd").hide().css("visibility","visible");$(".uccomfortkitpanel").hover(function(){$("body").attr("data-ucckp-hovered","true");},function(){$("body").attr("data-ucckp-hovered","false");});$(document).click(function(b){if($("body").attr("data-ucckp-hovered")!="true"&&$(".dropdownComfort").find("dd.visible").length>0){var c=$(".dropdownComfort");c.find("dd").fadeOut("fast").removeClass("visible");c.find("dt").removeClass("active");if($.browser.msie){$("ul.add-on-forms").children("li").show();$("div.ssrWrapper").find(".comfortKitPanelBtn").show();}}});$(".uccomfortkitpanel-close-btn").click(function(b){var c=$(".dropdownComfort");c.find("dd").fadeOut("fast").removeClass("visible");c.find("dt").removeClass("active");if($.browser.msie){$("ul.add-on-forms").children("li").show();$("div.ssrWrapper").find(".comfortKitPanelBtn").show();}return false;});var a=$(".dropdownComfort");a.find("dt").children("a").click(function(e){e.stopPropagation();var d=$(this).closest(".dropdownComfort");if(d.find("dd").hasClass("visible")){d.find("dd").fadeOut("fast",function(){});d.find("dd").removeClass("visible");d.find("dt").removeClass("active");if($.browser.msie){$("ul.add-on-forms").children("li").show();$("div.ssrWrapper").find(".comfortKitPanelBtn").show();}}else{d.find("dd").hide().removeClass("visible");d.find("dt").removeClass("active");var b=d.find(".uccomfortkitpanel-wrapper");var c=d.find("dd");var f=20;c.css({"visibility":"hidden","display":"block"});b.css("left",0);if(b.offset().left+b.outerWidth()+f>$(window).width()){if(b.outerWidth()>$(window).width()){b.css("left","-"+b.offset().left+"px");}else{b.css("left","-"+(b.offset().left+f+b.outerWidth()-$(window).width())+"px");}}c.css({"display":"none","visibility":"visible"});c.addClass("visible");d.find("dt").addClass("active");b.hide();c.show();b.show(500,function(){});}return false;});$(".uccomfortkitpanel").ucComfortKitPanel("onchange");}function setupDutyFreePanels(){var a=$(".dropdownDutyFree");a.find("dd").each(function(){$(this).attr("data-width",$(this).find(".ucdutyfreepanel").outerWidth());});a.find("dd").hide().css("visibility","visible");$(".ucdutyfreepanel").hover(function(){$("body").attr("data-ucckp-hovered","true");},function(){$("body").attr("data-ucckp-hovered","false");});$(document).click(function(c){if($("body").attr("data-ucckp-hovered")!="true"&&$(".dropdownDutyFree").find("dd.visible").length>0){var b=$(".dropdownDutyFree");b.find("dd").fadeOut("fast").removeClass("visible");b.find("dt").removeClass("active");if($.browser.msie){$("ul.add-on-forms").children("li").show();$("div.ssrWrapper").find(".dutyFreePanelBtn").show();}}});$(".ucdutyfreepanel-close-btn").click(function(c){var b=$(".dropdownDutyFree");b.find("dd").fadeOut("fast").removeClass("visible");b.find("dt").removeClass("active");if($.browser.msie){$("ul.add-on-forms").children("li").show();$("div.ssrWrapper").find(".dutyFreePanelBtn").show();}return false;});var a=$(".dropdownDutyFree");a.find("dt").children("a").click(function(e){e.stopPropagation();var d=$(this).closest(".dropdownDutyFree");if(d.find("dd").hasClass("visible")){d.find("dd").fadeOut("fast",function(){});d.find("dd").removeClass("visible");d.find("dt").removeClass("active");if($.browser.msie){$("ul.add-on-forms").children("li").show();$("div.ssrWrapper").find(".dutyFreePanelBtn").show();}}else{d.find("dd").hide().removeClass("visible");d.find("dt").removeClass("active");var b=d.find(".ucdutyfreepanel-wrapper");var c=d.find("dd");var f=20;c.css({"visibility":"hidden","display":"block"});b.css("left",0);if(b.offset().left+b.outerWidth()+f>$(window).width()){if(b.outerWidth()>$(window).width()){b.css("left","-"+b.offset().left+"px");}else{b.css("left","-"+(b.offset().left+f+b.outerWidth()-$(window).width())+"px");}}c.css({"display":"none","visibility":"visible"});c.addClass("visible");d.find("dt").addClass("active");b.hide();c.show();b.show(500,function(){});}return false;});$(".ucdutyfreepanel").ucDutyFreePanel("onchange");}function ssrToSidebar(e,c,d,a){if(c==""||typeof a=="undefined"){if(d=="depart"){AASideBar.remove_departAddon(e);}else{AASideBar.remove_returnAddon(e);}}else{for(x in a.ListOfSSRObj){if(a.ListOfSSRObj[x].SSRCode==c){var b={"id":e,"ssrcode":a.ListOfSSRObj[x].SSRCode,"currency":a.ListOfSSRObj[x].CurrencyCode,"ssrdescription":a.ListOfSSRObj[x].SSRDescription};}}for(y in a.LookupValues){if(a.LookupValues[y].Key==e){for(z in a.LookupValues[y].Value){if(a.LookupValues[y].Value[z].Key==c){b.amount=a.LookupValues[y].Value[z].Value;if(d=="depart"){AASideBar.add_departAddon(b);}else{AASideBar.add_returnAddon(b);}break;}}}}}}function ssrToSidebarValue(e,c,d){if(c==""){if(d=="depart"){AASideBar.remove_departAddon(e);}else{AASideBar.remove_returnAddon(e);}}else{var b=c.split("|");var a={"id":e,"ssrcode":b[0],"amount":b[1],"currency":b[2],"ssrdescription":b[3]};if(d=="depart"){AASideBar.add_departAddon(a);}else{AASideBar.add_returnAddon(a);}}}var _syncBaggageSelection_suspend=false;function syncBaggageSelection(a){var d=$("#"+a.get_id()).attr("data-direction");var c=a.get_selectedItem();var b=c!=null?c.get_value():a.get_value();var e=$("#"+a.get_id()).parents(".add-on-content:eq(0)").find(".cmbBaggage[data-direction="+d+"]");_syncBaggageSelection_suspend=true;e.each(function(g,h){var k=$(h).prop("id");if(k==a.get_id()){return;}var j=$find(k);var f=j.findItemByValue(b);j.trackChanges();if(f!=null){f.select();}else{j.get_items().getItem(0).select();}j.commitChanges();});_syncBaggageSelection_suspend=false;}var _syncSportsSelection_suspend=false;function syncSportsSelection(a){var d=$("#"+a.get_id()).attr("data-direction");var c=a.get_selectedItem();var b=c!=null?c.get_value():a.get_value();var e=$("#"+a.get_id()).parents(".add-on-content:eq(0)").find(".cmbSports[data-direction="+d+"]");_syncSportsSelection_suspend=true;e.each(function(g,h){var k=$(h).prop("id");if(k==a.get_id()){return;}var j=$find(k);var f=j.findItemByValue(b);j.trackChanges();if(f!=null){f.select();}else{j.get_items().getItem(0).select();}j.commitChanges();});_syncSportsSelection_suspend=false;}function adjustAddOnItemSizes(a){$("#"+a+" .ul-add-on-table-labels").each(function(){var b=$(this).parents(".div-add-on-table-container:eq(0)");$(this).children("li.row-label").each(function(c,e){var d=$(this).height();b.find(".ul-add-on-table").each(function(h,g){var f=$(this).find("li.row:eq("+c+")").height();if(f>d){d=f;}});if($(this).height()<d){$(this).css("height",d+"px");b.find(".ul-add-on-table").each(function(g,f){$(this).find("li.row:eq("+c+")").css("height",d+"px");});}});b.find(".separator1").css("height",$(this).height()+"px");});}function getInsurancePremiumForPassenger(b){if(typeof(b)=="string"){b=parseInt(b);}var g="BodyContent_ucTravelerForm"+(b+1)+"_form_";var a="ctl00_BodyContent_ucTravelerForm"+(b+1)+"_form_";var e="#"+g+"divInsurancePanel";var k="#"+g+"divExternalInsurance";var n="",h="";var c=$find(a+"cmbDOBYear");var l=c.get_value();n=l+"-";c=$find(a+"cmbDOBMonth");var j=c.get_value();if(j<10){n=n+"0"+j+"-";}else{n=n+j+"-";}c=$find(a+"cmbDOBDay");var m=c.get_value();c=$find(a+"cmbTitleCombo");if(c){if(c.get_value()==ucTravelerForm.Lang.Mr){h="0";}else{h="1";}}else{c=$find(a+"cmbGenderCombo");if(c.get_value()=="1"){h="0";}else{h="1";}}if(!isValidDate(l,j,m)){combo=$find(a+"cmbDOBDay");combo.clearItems();var p=daysInMonth(j,l);for(var d=0;d<daysInMonth(j,l);d++){var o=new Telerik.Web.UI.RadComboBoxItem();var f=d+1;o.set_text(f.toString());o.set_value(f.toString());combo.trackChanges();combo.get_items().add(o);if(m>p){o.select();}combo.commitChanges();}}c=$find(a+"cmbDOBDay");m=c.get_value();if(m<10){n=n+"0"+m+" 00:00:00";}else{n=n+m+" 00:00:00";}if($find(a+"cmbDOBYear").get_value().length>0){$.ajax({type:"POST",url:"Traveler.aspx/GetPersonalInsurancePremium",data:"{dob: '"+n+"', gender: '"+h+"', culture: '"+culture+"'}",contentType:"application/json",dataType:"json",success:function(s){if(s.d=="0"){$(k).show();$(k+" div:[id=extInsuranceDesc]").html(ucTravelerForm.Lang.InsuranceDesc_Zurich);}else{if(s.d!="-1"){var r=new String(s.d);r=r.replace("[","");r=r.replace("]","");var q=r.split("|");$(e+" input:checkbox").each(function(){$(e).show();if($(this).is(":checked")==true&&iUntickInsFlag==1){$(this).prop("checked",true);}else{if(iUntickInsFlag==1){$(this).removeAttr("checked");}else{$(this).prop("checked",true);}}$(this).prop("value",q[0]);var t=$(e+" input:hidden");t.prop("value",q[0]);var u=$(e+" label");u.text(q[2]+" "+q[1]);$(e+" div:[id=aaInsureNotification]").html(q[3]);$(e+" div:[id=aaInsureNote]").text(q[4]);initMoreButton();if(SSRInsure==undefined){SSRInsure={"ListOfSSRObj":[{"SSRCode":q[0],"SSRDescription":Traveler.Lang.AAInsure,"CurrencyCode":q[1]}],"LookupValues":[{"Key":$(this)[0].id,"Value":[{"Key":q[0],"Value":q[2]}]}]};}else{var v=0;for(x in SSRInsure.LookupValues){if(SSRInsure.LookupValues[x].Key==$(this)[0].id){SSRInsure.LookupValues[x].Value=[{"Key":q[0],"Value":q[2]}];v=1;}}if(v==0){SSRInsure.LookupValues.push({"Key":$(this)[0].id,"Value":[{"Key":q[0],"Value":q[2]}]});}}if(q[5]!=""){chkTravelInsuranceChanged($(this)[0],q[0],"return");}else{chkTravelInsuranceChanged($(this)[0],q[0],"depart");}});}else{$(e).hide();$(k).hide();}}}});}}function radTabContact_TabSelected(e,b){var a=$find(radTabStrip1);var d=a.get_tabs();for(var c=0;c<d.get_count();c++){d.getTab(c).set_selected(false);}var f=$find(radMultiPage);f.set_visible(false);if(b.get_tab().get_index()==0){$("#divGuestDetailForm").hide();$("#divGuestDetailSubForm").hide();$("#divGuestListForm").hide();$("#divContactForm").show();}else{if(b.get_tab().get_index()==1){$("#divGuestDetailForm").hide();$("#divGuestDetailSubForm").hide();$("#divContactForm").hide();$("#divGuestListForm").show();}}}function radTabGuest_TabSelecting(h,g){if(!Page_ClientValidate("ContactGroupVal")){g.set_cancel(true);alert(TravelerVal.Lang.AlrtGuestDetails);}else{var b=new RegExp("ucTravelerForm[0-9]+");var e=b.exec(h.get_id());var f="#ctl00_BodyContent_"+e+"_form_";var d=f+"txtFirstName"+"_text";var a=f+"txtLastName"+"_text";var c=f+"txtDOB";}}function radTabGuest_TabSelected(d,f){var h=$find(radTabContact);var g=h.get_tabs();for(var e=0;e<g.get_count();e++){g.getTab(e).set_selected(false);}var a=$find(radMultiPage);a.set_visible(true);$("#divGuestDetailForm").show();$("#divGuestDetailSubForm").show();$("#divGuestListForm").hide();$("#divContactForm").hide();var b=$find(radTabStrip1).get_selectedIndex();if(b>0){var c="#BodyContent_ucTravelerForm"+(b+1)+"_form_chkIAmFlying";$(c).parent().hide();}var j="#BodyContent_ucTravelerForm"+(b+1);adjustAddOnItemSizes(j.substr(1));}function baggage1selectedValue(b,a){var d=a.get_item();var c=d!=null?d.get_value():b.get_value();ssrToSidebar(b.get_id(),c,"depart");}function baggage2selectedValue(b,a){var d=a.get_item();var c=d!=null?d.get_value():b.get_value();ssrToSidebar(b.get_id(),c,"return");}function baggage1selected(b,a){var d=a.get_item();var c=d!=null?d.get_value():b.get_value();ssrToSidebar(b.get_id(),c,"depart",SSRBaggage[$("#"+b.get_id()).parents("#divGuestDetailForm").data("pageNumber")]);if(!_syncBaggageSelection_suspend){syncBaggageSelection(b);if(baggagePromptSSR.indexOf(c)!=-1&&c!=""){alert(TravelerVal.Lang.AlrtBaggagePrompt);}}}function baggage2selected(b,a){var d=a.get_item();var c=d!=null?d.get_value():b.get_value();ssrToSidebar(b.get_id(),c,"return",SSRBaggage[$("#"+b.get_id()).parents("#divGuestDetailForm").data("pageNumber")]);if(!_syncBaggageSelection_suspend){syncBaggageSelection(b);if(baggagePromptSSR.indexOf(c)!=-1&&c!=""){alert(TravelerVal.Lang.AlrtBaggagePrompt);}}}function openMealPanel(d){$(".dropdown dd").hide();$(".dropdown dd").removeClass("visible");$(".dropdown dt").removeClass("active");var a=$(d).find(".ucmealpanel-wrapper");var b=$(d).find("dd");var c=20;b.css("visibility","hidden");b.css("display","block");a.css("left",0);if(a.offset().left+a.outerWidth()+c>$(window).width()){if(a.outerWidth()>$(window).width()){a.css("left","-"+a.offset().left+"px");}else{a.css("left","-"+(a.offset().left+c+a.outerWidth()-$(window).width())+"px");}}b.css("display","none");b.css("visibility","visible");b.addClass("visible");$(d).find("dt").addClass("active");a.hide();b.show();a.show(500,function(){});}function sportseq1selected(b,a){var d=a.get_item();var c=d!=null?d.get_value():b.get_value();ssrToSidebar(b.get_id(),c,"depart",SSRSportsEq[$("#"+b.get_id()).parents("#divGuestDetailForm").data("pageNumber")]);if(!_syncSportsSelection_suspend){syncSportsSelection(b);}}function sportseq2selected(b,a){var d=a.get_item();var c=d!=null?d.get_value():b.get_value();ssrToSidebar(b.get_id(),c,"return",SSRSportsEq[$("#"+b.get_id()).parents("#divGuestDetailForm").data("pageNumber")]);if(!_syncSportsSelection_suspend){syncSportsSelection(b);}}function ssrCheckbox1checkChanged(a,b){if(a.checked==true){ssrToSidebar(a.id,b,"depart",SSRLookup[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}else{ssrToSidebar(a.id,"","depart",SSRLookup[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}}function ssrCheckbox2checkChanged(a,b){if(a.checked==true){ssrToSidebar(a.id,b,"return",SSRLookup[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}else{ssrToSidebar(a.id,"","return",SSRLookup[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}}function ssrRedCarpet1checkChanged(a,b){if(a.checked==true){ssrToSidebar(a.id,b,"depart",SSRucTravelerForm[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}else{ssrToSidebar(a.id,"","depart",SSRucTravelerForm[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}}function ssrRedCarpet2checkChanged(a,b){if(a.checked==true){ssrToSidebar(a.id,b,"return",SSRucTravelerForm[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}else{ssrToSidebar(a.id,"","return",SSRucTravelerForm[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}}function ssrGoldCoast1checkChanged(a,b){if(a.checked==true){ssrToSidebar(a.id,b,"depart",SSRucTravelerForm[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}else{ssrToSidebar(a.id,"","depart",SSRucTravelerForm[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}}function ssrGoldCoast2checkChanged(a,b){if(a.checked==true){ssrToSidebar(a.id,b,"return",SSRucTravelerForm[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}else{ssrToSidebar(a.id,"","return",SSRucTravelerForm[$("#"+a.id).parents("#divGuestDetailForm").data("pageNumber")]);}}function ucTravelerFormComboBoxChangedDepart(b,a){var d=a.get_item();var c=d!=null?d.get_value():b.get_value();ssrToSidebar(b.get_id(),c,"depart",SSRucTravelerForm[$("#"+b.get_id()).parents("#divGuestDetailForm").data("pageNumber")]);}function ucTravelerFormComboBoxChangedReturn(b,a){var d=a.get_item();var c=d!=null?d.get_value():b.get_value();ssrToSidebar(b.get_id(),c,"return",SSRucTravelerForm[$("#"+b.get_id()).parents("#divGuestDetailForm").data("pageNumber")]);}$(function(){$(document).ready(function(){$(".ucmealpanel").ucMealPanel("onchange",function(e,d){var b=e.ucMealPanel("getSelectedItems");var a=e.hasClass("mealpanel-depart");var c=new Array();for(i in b){var f={"title":b[i].description,"value":b[i].price,"quantity":b[i].quantity,"currency":b[i].currency};c.push(f);}});});});function cmbTitleCombo_SelectedIndexChanged(c,b){var a=parseInt($("#"+c.get_id()).parents(".divGuestDetailForm:eq(0)").attr("data-page-number"));getInsurancePremiumForPassenger(a);}function txtFirstName_ValueChanged(c,e){var a=$("#"+c.get_id()).parents(".divGuestDetailForm:eq(0)").attr("data-page-number");var g=new RegExp("ucTravelerForm[0-9]+");var b=g.exec(c.get_id());var f="ctl00_BodyContent_"+b+"_form_txtLastName";var h=e.get_newValue();var j=$find(f).get_value();var d=(h!=""&&j!="")?", ":"";if(h!=""||j!=""){$($find(radTabGuest).get_tabs().getTab(a).get_element()).find(".rtsTxt").addClass("with-name");$($find(radTabGuest).get_tabs().getTab(a).get_element()).find(".rtsTxt .name").text(j+d+h);}else{$($find(radTabGuest).get_tabs().getTab(a).get_element()).find(".rtsTxt").removeClass("with-name");$($find(radTabGuest).get_tabs().getTab(a).get_element()).find(".rtsTxt .name").text("");}}function txtLastName_ValueChanged(c,e){var a=$("#"+c.get_id()).parents(".divGuestDetailForm:eq(0)").attr("data-page-number");var f=new RegExp("ucTravelerForm[0-9]+");var b=f.exec(c.get_id());var g="ctl00_BodyContent_"+b+"_form_txtFirstName";var h=$find(g).get_value();var j=e.get_newValue();var d=(h!=""&&j!="")?", ":"";if(h!=""||j!=""){$($find(radTabGuest).get_tabs().getTab(a).get_element()).find(".rtsTxt").addClass("with-name");$($find(radTabGuest).get_tabs().getTab(a).get_element()).find(".rtsTxt .name").text(j+d+h);}else{$($find(radTabGuest).get_tabs().getTab(a).get_element()).find(".rtsTxt").removeClass("with-name");$($find(radTabGuest).get_tabs().getTab(a).get_element()).find(".rtsTxt .name").text("");}}function cmbDOBDay_SelectedIndexChanged(c,e){var f=new RegExp("ucTravelerForm[0-9]+");var a=f.exec(c.get_id());var d="BodyContent_"+a+"_form_hfDOBDay";document.getElementById(d).value=c.get_value();var b=parseInt($("#"+c.get_id()).parents(".divGuestDetailForm:eq(0)").attr("data-page-number"));var g=$("#BodyContent_"+a+"_form_cvDOBRequired").get(0);var h={IsValid:true};cvDOBRequired_Validator(g,h);var j=$("#BodyContent_"+a+"_form_cvDOBAge").get(0);ValidatorValidate(j);if(h.IsValid&&j.isvalid){getInsurancePremiumForPassenger(b);}}function cmbDOBMonth_SelectedIndexChanged(c,d){var e=new RegExp("ucTravelerForm[0-9]+");var m=e.exec(c.get_id());var p=new Date();var t="ctl00_BodyContent_"+m+"_form_";var u="BodyContent_"+m+"_form_hfDOBMonth";document.getElementById(u).value=c.get_value();combo=$find(t+"cmbDOBYear");var n=combo.get_value();if(isEmpty(n)){n=p.getYear();}combo=$find(t+"cmbDOBMonth");var s=combo.get_value();combo=$find(t+"cmbDOBDay");var q=combo.get_value();var a="#"+t+"txtDOB";$(a).hide_message({});if(!isValidDate(n,s,q)){combo=$find(t+"cmbDOBDay");combo.clearItems();var h=daysInMonth(s,n);var b=new Telerik.Web.UI.RadComboBoxItem();b.set_text("");b.set_value("");combo.trackChanges();combo.get_items().add(b);if(q>h){b.select();}combo.commitChanges();for(var r=0;r<daysInMonth(s,n);r++){var o=new Telerik.Web.UI.RadComboBoxItem();var j=r+1;o.set_text(j.toString());o.set_value(j.toString());combo.trackChanges();combo.get_items().add(o);if(q>h){o.select();}combo.commitChanges();}}var g=parseInt($("#"+c.get_id()).parents(".divGuestDetailForm:eq(0)").attr("data-page-number"));var f=$("#BodyContent_"+m+"_form_cvDOBRequired").get(0);var k={IsValid:true};cvDOBRequired_Validator(f,k);var l=$("#BodyContent_"+m+"_form_cvDOBAge").get(0);ValidatorValidate(l);if(k.IsValid&&l.isvalid){getInsurancePremiumForPassenger(g);}}function cmbDOBYear_SelectedIndexChanged(c,e){var f=new RegExp("ucTravelerForm[0-9]+");var a=f.exec(c.get_id());var d="BodyContent_"+a+"_form_hfDOBYear";document.getElementById(d).value=c.get_value();var b=parseInt($("#"+c.get_id()).parents(".divGuestDetailForm:eq(0)").attr("data-page-number"));var g=$("#BodyContent_"+a+"_form_cvDOBRequired").get(0);var h={IsValid:true};cvDOBRequired_Validator(g,h);var j=$("#BodyContent_"+a+"_form_cvDOBAge").get(0);ValidatorValidate(j);if(h.IsValid&&j.isvalid){getInsurancePremiumForPassenger(b);}}function chkTravelInsuranceChanged(a,c,b){if(a.checked==true){ssrToSidebar(a.id,c,b,SSRInsure);}else{ssrToSidebar(a.id,"",b,SSRInsure);}}function chkRedCarpetChanged(a,c,b){if(a.checked==true){ssrToSidebar(a.id,c,b,SSRInsure);}else{ssrToSidebar(a.id,"",b,SSRInsure);}}$(function(){});